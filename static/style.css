body {
    margin: 0;
    padding: 0;
    background-color: #121212;
    color: white;
    font-family: Arial, sans-serif;
}

.chat-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-width: 700px;
    margin: 0 auto;
}

#chat-box {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.chat-message {
    display: flex;
}

.chat-message.user {
    justify-content: flex-end;
}

.chat-message.assistant {
    justify-content: flex-start;
}

.bubble {
    max-width: 70%;
    padding: 10px 15px;
    border-radius: 15px;
    background-color: #2a2a2a;
    line-height: 1.5;
}

.chat-message.user .bubble {
    background-color: #0077cc;
    color: white;
}

.input-container {
    display: flex;
    padding: 10px;
    background-color: #1e1e1e;
    border-top: 1px solid #333;
}

input#user-input {
    flex: 1;
    padding: 10px;
    font-size: 16px;
    background-color: #2a2a2a;
    border: none;
    color: white;
    border-radius: 8px;
}

button {
    margin-left: 10px;
    padding: 10px 20px;
    background-color: #0077cc;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

button:hover {
    background-color: #005fa3;
}

#send-btn {
  width: 44px;
  height: 44px;
  margin-left: 10px;
  padding: 0;
  display: grid;
  place-items: center;
  border-radius: 10px; /* æ¯”è¼ƒåƒèŠå¤© App */
  font-size: 0; /* ç§»é™¤æ–‡å­—é–“è· */
}

/* ç¦ç”¨æ™‚çš„æ¨£å¼ */
#send-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* å‚³é€ä¸­å¯åŠ å€‹å¾®å‹•æ…‹ï¼ˆå¯é¸ï¼‰ */
#send-btn.is-sending svg {
  transform-origin: 50% 50%;
  animation: btnPulse 0.8s ease-in-out infinite;
}
@keyframes btnPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(0.92); }
}

/* æ€è€ƒä¸­ï¼šè½‰åœˆåœˆ */
.spinner {
  width: 16px;
  height: 16px;
  border: 3px solid rgba(255,255,255,0.2);
  border-top-color: #fff;
  border-radius: 50%;
  display: inline-block;
  animation: spin 1s linear infinite;
  margin-right: 8px;
  vertical-align: -2px;
}
@keyframes spin { to { transform: rotate(360deg); } }

.typing-text {
  opacity: 0.8;
  font-size: 0.9em;
}

/* è®“ assistant çš„è¼‰å…¥æ³¡æ³¡ç•¥é¡¯ä¸åŒï¼ˆå¯é¸ï¼‰ */
.chat-message.assistant.typing .bubble {
  background-color: #2f2f2f;
  opacity: 0.95;
}

/* å…¨åŸŸ */
:root {
  --bg: #1e1e1e;
  --panel: #2b2b2b;
  --panel-2: #242424;
  --text: #ffffff;
  --muted: #b9b9b9;
  --primary: #0a84ff;
  --bubble-user: #0a84ff;
  --bubble-assistant: #2f2f2f;
  --radius: 12px;
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans TC", sans-serif;
}

/* é ‚éƒ¨æ¬„ */
.app-header {
  height: 56px;
  border-bottom: 1px solid #000;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 16px;
  background: var(--panel-2);
  position: sticky; top: 0; z-index: 10;
}
.brand { font-size: 18px; letter-spacing: .5px; opacity: .95; }

/* Layout */
.app-shell {
  display: grid;
  grid-template-columns: 280px 1fr;
  height: calc(100vh - 56px);
}

/* å·¦å´ï¼šå°è©±åˆ—è¡¨ */
.sidebar {
  border-right: 1px solid #000;
  background: #202020;
  display: flex; flex-direction: column;
}
.sidebar-top { padding: 12px; border-bottom: 1px solid #000; }
.sidebar .primary {
  width: 100%;
  height: 40px;
  border-radius: 10px;
  border: none;
  background: var(--primary);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}
.conv-list { overflow-y: auto; padding: 8px; }
.conv-item {
  padding: 10px 12px;
  border-radius: 10px;
  background: transparent;
  cursor: pointer;
}
.conv-item:hover { background: rgba(255,255,255,0.06); }
.conv-item.active { background: rgba(10,132,255,0.20); }
.conv-title { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.conv-preview { font-size: 12px; color: var(--muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; opacity: .9; }

/* å³å´ï¼šèŠå¤©å€ */
.chat-area {
  display: flex; flex-direction: column; height: 100%;
}
.chat-box {
  flex: 1; overflow-y: auto;
  background: var(--bg);
  padding: 16px 20px;
}
.chat-message { margin: 10px 0; display: flex; }
.chat-message.user { justify-content: flex-end; }
.chat-message .bubble {
  max-width: 140ch;
  padding: 12px 14px;
  border-radius: var(--radius);
  box-shadow: 0 0 5px #000;
  background: var(--bubble-assistant);
  white-space: pre-wrap;   /* â¬…ï¸ é€™è¡Œè¶…é‡è¦ */
  line-height: 1.6;
}
.chat-message.user .bubble {
  background: var(--bubble-user);
  color: #fff;
}
.input-row {
  display: flex; gap: 10px;
  padding: 12px;
  border-top: 1px solid #000;
  background: var(--panel);
}
#user-input {
  flex: 1; height: 44px; border-radius: 10px;
  border: 1px solid #3a3a3a; background: #1b1b1b; color: #fff;
  padding: 0 12px; outline: none;
}
#user-input::placeholder { color: #aaaaaa; }

/* Arrow button */
#send-btn {
  width: 44px; height: 44px; border-radius: 10px;
  border: none; background: var(--primary); color: white;
  display: grid; place-items: center; cursor: pointer;
}
#send-btn:disabled { opacity: 0.6; cursor: not-allowed; }
#send-btn.is-sending svg {
  transform-origin: 50% 50%;
  animation: btnPulse 0.8s ease-in-out infinite;
}
@keyframes btnPulse { 0%,100%{transform:scale(1)} 50%{transform:scale(.92)} }

/* Typing spinner */
.spinner {
  width: 16px; height: 16px;
  border: 3px solid rgba(255,255,255,0.2);
  border-top-color: #fff;
  border-radius: 50%;
  display: inline-block;
  animation: spin 1s linear infinite;
  margin-right: 8px; vertical-align: -2px;
}
@keyframes spin { to { transform: rotate(360deg); } }
.typing-text { opacity: 0.85; font-size: 0.9em; }
.chat-message.assistant.typing .bubble { background: #2f2f2f; opacity: .95; }

/* é ‚éƒ¨ Header å›ºå®š */
.app-header {
  height: 56px;
  border-bottom: 1px solid #000;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 16px;
  background: #242424;
  position: fixed;    /* âœ… å›ºå®š */
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
}

/* App Shellï¼šHeader ä¸‹é¢åˆ†å…©æ¬„ */
.app-shell {
  display: grid;
  grid-template-columns: 280px 1fr;
  height: calc(100vh - 56px);  /* æ‰£æ‰ Header é«˜åº¦ */
  margin-top: 56px;            /* é ç•™ Header ç©ºé–“ */
}

/* å·¦é‚Š Sidebarï¼šå°è©±åˆ—è¡¨ */
.sidebar {
  display: flex;
  flex-direction: column;
  background: #202020;
  border-right: 1px solid #000;
  overflow-y: auto;     /* âœ… å·¦é‚Šç¨ç«‹æ²å‹• */
}

/* å°è©±åˆ—è¡¨é …ç›® */
.conv-list {
  flex: 1;
  overflow-y: auto;     /* å¦‚æœè¦é™åˆ¶åªåˆ—è¡¨æ»¾å‹•ï¼Œä¹Ÿå¯ä»¥æ”¾é€™è£¡ */
  padding: 8px;
}

/* å³é‚Š Chat å€åŸŸ */
.chat-area {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;     /* é˜²æ­¢é›™é‡æ²è»¸ */
}

/* è¨Šæ¯å®¹å™¨ */
.chat-box {
  flex: 1;
  overflow-y: auto;     /* âœ… å³é‚Šç¨ç«‹æ²å‹• */
  padding: 16px 20px;
  background: #1e1e1e;
}

/* ä¸‹æ–¹è¼¸å…¥åˆ—å›ºå®šåœ¨å³å´åº•éƒ¨ */
.input-row {
  display: flex;
  gap: 10px;
  padding: 12px;
  border-top: 1px solid #000;
  background: #2b2b2b;
}

.conv-item {
  position: relative;
  padding-right: 42px; /* çµ¦å³å´æŒ‰éˆ•ä¸€é»ç©ºé–“ */
}
.conv-actions {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  gap: 6px;
  opacity: 0;
  transition: opacity .15s ease;
}
.conv-item:hover .conv-actions { opacity: .9; }
.icon-btn {
  width: 28px; height: 28px; border: none; border-radius: 6px;
  background: rgba(255,255,255,0.08); color: #fff; cursor: pointer;
  display: grid; place-items: center;
}
.icon-btn:hover { background: rgba(255,255,255,0.16); }
.icon-btn.danger:hover { background: rgba(255, 71, 87, 0.35); }

/* ========== ğŸ“˜ åƒè€ƒè³‡æ–™å½ˆçª—æ¨£å¼ ========== */
.modal {
  display: none; /* é è¨­éš±è— */
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.6);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: #1e1e1e;
  color: #f0f0f0;
  border-radius: 12px;
  padding: 24px;
  max-width: 700px;
  width: 90%;
  max-height: 80%;
  overflow-y: auto;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.5);
  animation: fadeIn 0.3s ease;
}

.close-btn {
  float: right;
  font-size: 24px;
  cursor: pointer;
  color: #bbb;
}

.close-btn:hover {
  color: #fff;
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}


/* ===== ğŸ’¬ ChatGPT è¼¸å…¥æ¬„æ¨£å¼ ===== */
.chatgpt-input-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px;
  background: linear-gradient(to top, #1b1b1b, transparent);
  border-top: 1px solid #2a2a2a;
  position: sticky;
  bottom: 0;
  z-index: 5;
}

.chatgpt-input-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #2a2a2a;
  border: 1px solid #3a3a3a;
  border-radius: 24px;
  padding: 10px 14px;
  width: 80%;
  max-width: 900px;
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
  transition: all 0.2s ease;
}

.chatgpt-input-container:focus-within {
  border-color: #0a84ff;
  box-shadow: 0 0 20px rgba(10, 132, 255, 0.3);
}

.chatgpt-input-container textarea {
  flex: 1;
  resize: none;
  background: transparent;
  border: none;
  outline: none;
  color: white;
  font-size: 15px;
  line-height: 1.4;
  padding-right: 12px;
  font-family: system-ui, "Noto Sans TC", sans-serif;
}

.chatgpt-input-container button {
  background: var(--primary);
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.25s ease;
}

.chatgpt-input-container button:hover {
  background: #0071e3;
}

.input-hint {
  color: #888;
  font-size: 12px;
  margin-top: 6px;
  text-align: center;
  opacity: 0.8;
}

.toolbar { display:flex; align-items:center; gap:8px; margin:8px 0; }
.k-label { font-size:12px; opacity:.8; }
.k-input {
  width:72px; padding:6px 8px; border-radius:8px; border:1px solid #444;
  background:#1f1f1f; color:#eaeaea;
}

/* åŠ©ç†æ³¡æ³¡å¯é»æ“Šé¡¯ç¤ºæ‰‹å‹¢ */
.bubble.clickable { cursor:pointer; box-shadow:0 0 0 1px rgba(255,255,255,.07) inset; }
.bubble.clickable:hover { background:rgba(255,255,255,.04); }



.close-btn {
  background:transparent; color:#aaa; border:0; font-size:18px; cursor:pointer;
}
.close-btn:hover { color:#fff; }

/* é€å‡ºæ™‚é–ä½æŒ‰éˆ•çš„è¦–è¦ºç‹€æ…‹ */
#send-btn.is-sending { opacity:.6; pointer-events:none; }

/* ===== Top-K å·¥å…·åˆ— ===== */
.toolbar{
  display:flex;
  align-items:center;
  gap:10px;
  margin:8px 0 2px;
}

.k-label{
  font-size:12px;
  color:#c9ced6;
  opacity:.9;
}

.k-range{
  width:240px;
}

.k-number{
  width:72px;
  background:#111418;
  color:#e7eaee;
  border:1px solid #2a2f36;
  border-radius:8px;
  padding:6px 8px;
}

.k-hidden{
  display:none; /* è®“èˆŠçš„ kInput ä¿ç•™ä½†ä¸å ä½ */
}

.pdf-inline-bar {
  margin-top: 8px;
  font-size: 13px;
  color: #cfd2dc;
}

.pdf-inline-bar a {
  color: #0a84ff;
  text-decoration: underline;
}

.pdf-inline-bar a:hover {
  text-decoration: none;
  opacity: 0.9;
}

/* ===== åŠ©ç†è¨Šæ¯ä¸‹æ–¹çš„ PDF é€£çµåˆ— ===== */
.pdf-links-row {
  margin-top: 6px;
  padding: 6px 10px;
  max-width: 70ch;
  border-radius: 10px;
  background: #151515;
  font-size: 13px;
  color: #d0d0d0;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

/* è®“è¨Šæ¯å¯åœ¨åŒä¸€è¡Œæ”¾æ³¡æ³¡ + ä¸‰é»æŒ‰éˆ• */
.chat-message {
  display: flex;
  margin: 10px 0;
}

.chat-message.assistant {
  justify-content: flex-start;
  align-items: flex-start;
}

/* è®“æ³¡æ³¡å…§æ–‡å­—ä¿ç•™æ›è¡Œï¼ˆå¦‚æœä½ æ”¹ç”¨ <br> ä¹Ÿæ²’å·®ï¼Œä½†é€™æ¨£æ›´ç©©ï¼‰ */
.chat-message .bubble {
  white-space: pre-wrap;
}

/* ä¸‰å€‹é»é»æŒ‰éˆ•æ¨£å¼ */
.msg-menu-btn {
  margin-left: 6px;
  margin-top: 4px;
  padding: 2px 8px;
  border-radius: 999px;
  border: none;
  background: transparent;
  color: #aaaaaa;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
}

.msg-menu-btn:hover {
  background: rgba(255, 255, 255, 0.08);
  color: #ffffff;
}

.avatar-btn {
  background: none;
  border: none;
  color: white;
  font-size: 20px;
  cursor: pointer;
  margin-right: 10px;
}

#profileModal .modal-content {
  width: 400px;
}

#profileModal select,
#profileModal input {
  width: 100%;
  margin: 5px 0 15px 0;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #444;
  background: #222;
  color: white;
}